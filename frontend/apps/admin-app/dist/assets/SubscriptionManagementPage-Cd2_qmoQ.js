import{d as R,j as d,k as D,z as u,c as l,a as t,B as w,C as I,E as _,n as v,y as x,F as N,r as S,o as r,t as b}from"./index-DhSIbSTO.js";const $={class:"p-8"},M={class:"bg-white p-6 rounded-lg shadow mb-8"},U={class:"flex gap-4 items-end"},O={class:"flex gap-2 mb-4"},A={class:"bg-white rounded shadow"},V={key:0,class:"p-8 text-center text-gray-500"},B={key:1,class:"w-full text-left border-collapse"},J={class:"p-4"},T={class:"p-4"},F={class:"p-4 font-medium"},G={class:"p-4"},L={class:"p-4 text-sm"},q={class:"p-4 space-x-2"},j=["onClick"],z=["onClick"],H={key:0},W=R({__name:"SubscriptionManagementPage",setup(K){const m=d([]),c=d(!0),i=d("all"),o=d(null),p=d("PRO"),y=d(null);D(async()=>{await g()});const g=async()=>{try{c.value=!0;const a=await u.get("/admin/subscription-requests");m.value=a.data}catch(a){console.error(a)}finally{c.value=!1}},f=async a=>{try{c.value=!0,i.value=a;const e=await u.get(`/admin/subscription-requests/status/${a}`);m.value=e.data}catch(e){console.error(e)}finally{c.value=!1}},P=async a=>{var e,s;try{const n=await u.post(`/admin/subscription-requests/${a}/preview`);y.value=n.data,alert(`Preview loaded! Check console for details.
`+JSON.stringify(n.data,null,2))}catch(n){alert("Preview failed: "+(((s=(e=n.response)==null?void 0:e.data)==null?void 0:s.message)||n.message))}},C=async a=>{var e,s;if(confirm("Confirm this subscription request?"))try{await u.post(`/admin/subscription-requests/${a}/confirm`),alert("Subscription confirmed!"),await g()}catch(n){alert("Confirm failed: "+(((s=(e=n.response)==null?void 0:e.data)==null?void 0:s.message)||n.message))}},h=async()=>{var a,e;if(o.value)try{const s=await u.post("/admin/subscriptions/preview",{userId:o.value,newPlan:p.value});y.value=s.data,alert(`Preview:
`+JSON.stringify(s.data,null,2))}catch(s){alert("Preview failed: "+(((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||s.message))}},E=async()=>{var a,e;if(o.value&&confirm(`Confirm subscription change for user ${o.value} to ${p.value}?`))try{await u.post("/admin/subscriptions/confirm",{userId:o.value,newPlan:p.value,confirm:!0}),alert("Subscription updated!")}catch(s){alert("Confirm failed: "+(((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||s.message))}},k=a=>{switch(a){case"PENDING":return"bg-yellow-100 text-yellow-800";case"APPROVED":return"bg-green-100 text-green-800";case"REJECTED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(a,e)=>(r(),l("div",$,[e[12]||(e[12]=t("h1",{class:"text-2xl font-bold mb-6"},"Subscription Management",-1)),t("div",M,[e[9]||(e[9]=t("h2",{class:"font-bold text-lg mb-4"},"Direct Subscription Update",-1)),t("div",U,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium mb-1"},"User ID",-1)),w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s),type:"number",class:"border p-2 rounded w-32",placeholder:"User ID"},null,512),[[I,o.value,void 0,{number:!0}]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium mb-1"},"Plan",-1)),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),class:"border p-2 rounded"},[...e[7]||(e[7]=[t("option",{value:"FREE"},"FREE",-1),t("option",{value:"PRO"},"PRO",-1),t("option",{value:"PREMIUM"},"PREMIUM",-1)])],512),[[_,p.value]])]),t("button",{onClick:h,class:"bg-blue-600 text-white px-4 py-2 rounded"},"Preview"),t("button",{onClick:E,class:"bg-green-600 text-white px-4 py-2 rounded"},"Confirm")])]),t("div",O,[t("button",{onClick:e[2]||(e[2]=s=>{g(),i.value="all"}),class:v(["px-4 py-2 rounded",i.value==="all"?"bg-blue-600 text-white":"bg-gray-200"])}," All ",2),t("button",{onClick:e[3]||(e[3]=s=>f("PENDING")),class:v(["px-4 py-2 rounded",i.value==="PENDING"?"bg-yellow-500 text-white":"bg-gray-200"])}," Pending ",2),t("button",{onClick:e[4]||(e[4]=s=>f("APPROVED")),class:v(["px-4 py-2 rounded",i.value==="APPROVED"?"bg-green-600 text-white":"bg-gray-200"])}," Approved ",2),t("button",{onClick:e[5]||(e[5]=s=>f("REJECTED")),class:v(["px-4 py-2 rounded",i.value==="REJECTED"?"bg-red-600 text-white":"bg-gray-200"])}," Rejected ",2)]),t("div",A,[c.value?(r(),l("div",V,"Loading...")):(r(),l("table",B,[e[11]||(e[11]=t("thead",null,[t("tr",{class:"border-b bg-gray-50"},[t("th",{class:"p-4"},"ID"),t("th",{class:"p-4"},"User ID"),t("th",{class:"p-4"},"Requested Plan"),t("th",{class:"p-4"},"Status"),t("th",{class:"p-4"},"Created"),t("th",{class:"p-4"},"Actions")])],-1)),t("tbody",null,[(r(!0),l(N,null,S(m.value,s=>(r(),l("tr",{key:s.id,class:"border-b hover:bg-gray-50"},[t("td",J,b(s.id),1),t("td",T,b(s.userId),1),t("td",F,b(s.requestedPlan),1),t("td",G,[t("span",{class:v(["px-2 py-1 rounded text-xs font-medium",k(s.status)])},b(s.status),3)]),t("td",L,b(new Date(s.createdAt).toLocaleString()),1),t("td",q,[t("button",{onClick:n=>P(s.id),class:"text-blue-600 hover:underline"},"Preview",8,j),s.status==="PENDING"?(r(),l("button",{key:0,onClick:n=>C(s.id),class:"text-green-600 hover:underline"},"Confirm",8,z)):x("",!0)])]))),128)),m.value.length===0?(r(),l("tr",H,[...e[10]||(e[10]=[t("td",{colspan:"6",class:"p-8 text-center text-gray-500"},"No requests found",-1)])])):x("",!0)])]))])]))}});export{W as default};
