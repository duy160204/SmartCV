import{d as S,j as p,k as C,z as c,H as _,c as d,a as e,t as l,B as i,E as f,C as m,y as P,F as N,r as V,o as u,n as U}from"./index-DhSIbSTO.js";const k={class:"p-8"},E={class:"flex justify-between items-center mb-6"},A={class:"bg-green-100 text-green-800 px-4 py-2 rounded-lg font-bold"},F={class:"bg-white p-4 rounded-lg shadow mb-6"},M={class:"grid grid-cols-6 gap-4"},L={class:"bg-white rounded shadow overflow-hidden"},B={key:0,class:"p-8 text-center text-gray-500"},O={key:1,class:"w-full text-left border-collapse"},$={class:"p-4"},R={class:"p-4"},T={class:"p-4 font-medium"},j={class:"p-4"},z={class:"p-4"},G={class:"p-4 text-xs text-gray-500 font-mono"},Y={class:"p-4 text-sm"},H={key:0},K=S({__name:"PaymentListPage",setup(q){const n=p([]),r=p(!0),a=p({status:"",provider:"",userId:"",fromDate:"",toDate:""});C(async()=>{await y()});const y=async()=>{try{r.value=!0;const s=await c.get("/admin/payments");n.value=s.data}catch(s){console.error(s)}finally{r.value=!1}},b=async s=>{try{r.value=!0;const t=await c.get(`/admin/payments/status/${s}`);n.value=t.data}catch(t){console.error(t),alert("Filter failed")}finally{r.value=!1}},x=async s=>{try{r.value=!0;const t=await c.get(`/admin/payments/provider/${s}`);n.value=t.data}catch(t){console.error(t)}finally{r.value=!1}},D=async()=>{try{r.value=!0;const s={};a.value.userId&&(s.userId=a.value.userId),a.value.fromDate&&(s.from=a.value.fromDate),a.value.toDate&&(s.to=a.value.toDate);const t=await c.get("/admin/payments/search",{params:s});n.value=t.data}catch(s){console.error(s)}finally{r.value=!1}},v=async()=>{a.value={status:"",provider:"",userId:"",fromDate:"",toDate:""},await y()},h=_(()=>n.value.filter(s=>s.status==="SUCCESS").reduce((s,t)=>s+t.amount,0)),g=s=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s),w=s=>new Date(s).toLocaleString(),I=s=>{switch(s){case"SUCCESS":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"FAILED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(s,t)=>(u(),d("div",k,[e("div",E,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold"},"Payment Management",-1)),e("div",A," Total Revenue: "+l(g(h.value)),1)]),e("div",F,[e("div",M,[i(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>a.value.status=o),onChange:t[1]||(t[1]=o=>a.value.status?b(a.value.status):v()),class:"border p-2 rounded"},[...t[8]||(t[8]=[e("option",{value:""},"All Status",-1),e("option",{value:"SUCCESS"},"Success",-1),e("option",{value:"PENDING"},"Pending",-1),e("option",{value:"FAILED"},"Failed",-1)])],544),[[f,a.value.status]]),i(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.provider=o),onChange:t[3]||(t[3]=o=>a.value.provider?x(a.value.provider):v()),class:"border p-2 rounded"},[...t[9]||(t[9]=[e("option",{value:""},"All Providers",-1),e("option",{value:"VNPAY"},"VNPAY",-1),e("option",{value:"MOMO"},"MOMO",-1)])],544),[[f,a.value.provider]]),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>a.value.userId=o),type:"number",placeholder:"User ID",class:"border p-2 rounded"},null,512),[[m,a.value.userId]]),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>a.value.fromDate=o),type:"date",class:"border p-2 rounded"},null,512),[[m,a.value.fromDate]]),i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>a.value.toDate=o),type:"date",class:"border p-2 rounded"},null,512),[[m,a.value.toDate]]),e("div",{class:"flex gap-2"},[e("button",{onClick:D,class:"bg-blue-600 text-white px-4 py-2 rounded"},"Search"),e("button",{onClick:v,class:"bg-gray-200 px-4 py-2 rounded"},"Reset")])])]),e("div",L,[r.value?(u(),d("div",B,"Loading...")):(u(),d("table",O,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"border-b bg-gray-50"},[e("th",{class:"p-4"},"ID"),e("th",{class:"p-4"},"User ID"),e("th",{class:"p-4"},"Amount"),e("th",{class:"p-4"},"Provider"),e("th",{class:"p-4"},"Status"),e("th",{class:"p-4"},"Transaction ID"),e("th",{class:"p-4"},"Date")])],-1)),e("tbody",null,[(u(!0),d(N,null,V(n.value,o=>(u(),d("tr",{key:o.id,class:"border-b hover:bg-gray-50"},[e("td",$,l(o.id),1),e("td",R,l(o.userId),1),e("td",T,l(g(o.amount)),1),e("td",j,l(o.provider),1),e("td",z,[e("span",{class:U(["px-2 py-1 rounded text-xs font-medium",I(o.status)])},l(o.status),3)]),e("td",G,l(o.transactionId||"-"),1),e("td",Y,l(w(o.createdAt)),1)]))),128)),n.value.length===0?(u(),d("tr",H,[...t[10]||(t[10]=[e("td",{colspan:"7",class:"p-8 text-center text-gray-500"},"No payments found",-1)])])):P("",!0)])]))])]))}});export{K as default};
