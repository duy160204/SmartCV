import{d as D,e as F,r as p,g as S,h as y,c as n,a as e,l as A,w as L,k as M,t as g,i as I,q as b,n as m,s as w,v as c,o as d,m as N}from"./index-0B6RXuyq.js";const B={class:"min-h-screen bg-gray-50"},T={class:"bg-white border-b px-8 py-4 flex justify-between items-center"},$={class:"font-bold text-xl"},h={class:"max-w-4xl mx-auto mt-8 p-6 bg-white rounded shadow"},O={class:"flex border-b mb-6"},_={key:0,class:"space-y-4 max-w-md"},j={key:1,class:"space-y-4 max-w-md"},q={key:2},z={key:0,class:"text-gray-500"},G={key:1,class:"space-y-6"},H={class:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-lg"},J={class:"text-3xl font-bold"},K={key:0,class:"text-sm mt-2 opacity-80"},Q={class:"text-sm mt-1 opacity-80"},W={class:"grid grid-cols-3 gap-4"},X={key:0,class:"mt-4 w-full bg-blue-600 text-white py-2 rounded text-sm"},Y={key:0,class:"mt-4 w-full bg-indigo-600 text-white py-2 rounded text-sm"},Z={key:2,class:"text-gray-500"},ts=D({__name:"SettingsPage",setup(ss){var k,C;const f=F(),u=p("profile"),v=p({name:((k=f.user)==null?void 0:k.name)||"",avatarURL:((C=f.user)==null?void 0:C.avatarURL)||""}),o=p({currentPassword:"",newPassword:"",confirmPassword:""}),t=p(null),x=p(!1),P=p(null);S(async()=>{await U()});const U=async()=>{var a,s,r;try{x.value=!0,P.value=null;const i=await y.get("/subscription/me");t.value=((a=i.data)==null?void 0:a.data)||i.data}catch(i){console.error("Failed to load subscription",i),P.value=((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to load subscription",t.value={plan:"FREE",status:"ACTIVE"}}finally{x.value=!1}},E=async()=>{var a,s;try{await y.put("/users/profile",v.value),await f.checkAuth(),alert("Profile updated!")}catch(r){alert("Error: "+(((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.message)||r.message))}},V=async()=>{var a,s;if(o.value.newPassword!==o.value.confirmPassword){alert("Passwords do not match");return}try{await y.put("/users/password",{currentPassword:o.value.currentPassword,newPassword:o.value.newPassword}),alert("Password changed!"),o.value={currentPassword:"",newPassword:"",confirmPassword:""}}catch(r){alert("Error: "+(((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.message)||r.message))}},R=a=>new Date(a).toLocaleDateString();return(a,s)=>{var i;const r=M("router-link");return d(),n("div",B,[e("nav",T,[e("h1",$,[A(r,{to:"/dashboard"},{default:L(()=>[...s[8]||(s[8]=[N("SmartCV",-1)])]),_:1})]),e("div",null,g((i=I(f).user)==null?void 0:i.name),1)]),e("div",h,[s[22]||(s[22]=e("h2",{class:"text-2xl font-bold mb-6"},"Account Settings",-1)),e("div",O,[e("button",{onClick:s[0]||(s[0]=l=>u.value="profile"),class:m(["px-4 py-2",u.value==="profile"?"border-b-2 border-blue-600 font-bold":""])},"Profile",2),e("button",{onClick:s[1]||(s[1]=l=>u.value="password"),class:m(["px-4 py-2",u.value==="password"?"border-b-2 border-blue-600 font-bold":""])},"Security",2),e("button",{onClick:s[2]||(s[2]=l=>u.value="subscription"),class:m(["px-4 py-2",u.value==="subscription"?"border-b-2 border-blue-600 font-bold":""])},"Subscription",2)]),u.value==="profile"?(d(),n("div",_,[e("div",null,[s[9]||(s[9]=e("label",{class:"block mb-1 font-medium"},"Full Name",-1)),w(e("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>v.value.name=l),class:"w-full border p-2 rounded"},null,512),[[c,v.value.name]])]),e("div",null,[s[10]||(s[10]=e("label",{class:"block mb-1 font-medium"},"Avatar URL",-1)),w(e("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>v.value.avatarURL=l),class:"w-full border p-2 rounded"},null,512),[[c,v.value.avatarURL]])]),e("button",{onClick:E,class:"bg-blue-600 text-white px-4 py-2 rounded"},"Save Changes")])):b("",!0),u.value==="password"?(d(),n("div",j,[e("div",null,[s[11]||(s[11]=e("label",{class:"block mb-1 font-medium"},"Current Password",-1)),w(e("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>o.value.currentPassword=l),type:"password",class:"w-full border p-2 rounded"},null,512),[[c,o.value.currentPassword]])]),e("div",null,[s[12]||(s[12]=e("label",{class:"block mb-1 font-medium"},"New Password",-1)),w(e("input",{"onUpdate:modelValue":s[6]||(s[6]=l=>o.value.newPassword=l),type:"password",class:"w-full border p-2 rounded"},null,512),[[c,o.value.newPassword]])]),e("div",null,[s[13]||(s[13]=e("label",{class:"block mb-1 font-medium"},"Confirm Password",-1)),w(e("input",{"onUpdate:modelValue":s[7]||(s[7]=l=>o.value.confirmPassword=l),type:"password",class:"w-full border p-2 rounded"},null,512),[[c,o.value.confirmPassword]])]),e("button",{onClick:V,class:"bg-red-600 text-white px-4 py-2 rounded"},"Change Password")])):b("",!0),u.value==="subscription"?(d(),n("div",q,[x.value?(d(),n("div",z,"Loading subscription info...")):t.value?(d(),n("div",G,[e("div",H,[s[14]||(s[14]=e("div",{class:"text-sm opacity-80 mb-1"},"Current Plan",-1)),e("div",J,g(t.value.plan||"FREE"),1),t.value.endDate?(d(),n("div",K," Expires: "+g(R(t.value.endDate)),1)):b("",!0),e("div",Q," Status: "+g(t.value.status||"ACTIVE"),1)]),e("div",W,[e("div",{class:m(["border rounded-lg p-4",t.value.plan==="FREE"?"border-blue-500 bg-blue-50":""])},[...s[15]||(s[15]=[e("h4",{class:"font-bold text-lg"},"Free",-1),e("p",{class:"text-gray-500 text-sm mb-4"},"Basic features",-1),e("ul",{class:"text-sm space-y-1 text-gray-600"},[e("li",null,"✓ 3 CVs"),e("li",null,"✓ Basic templates"),e("li",null,"✗ PDF Download")],-1)])],2),e("div",{class:m(["border rounded-lg p-4",t.value.plan==="PRO"?"border-blue-500 bg-blue-50":""])},[s[16]||(s[16]=e("h4",{class:"font-bold text-lg"},"Pro",-1)),s[17]||(s[17]=e("p",{class:"text-gray-500 text-sm mb-4"},"$9.99/month",-1)),s[18]||(s[18]=e("ul",{class:"text-sm space-y-1 text-gray-600"},[e("li",null,"✓ 10 CVs"),e("li",null,"✓ All templates"),e("li",null,"✓ PDF Download")],-1)),t.value.plan!=="PRO"&&t.value.plan!=="PREMIUM"?(d(),n("button",X," Upgrade ")):b("",!0)],2),e("div",{class:m(["border rounded-lg p-4",t.value.plan==="PREMIUM"?"border-blue-500 bg-blue-50":""])},[s[19]||(s[19]=e("h4",{class:"font-bold text-lg"},"Premium",-1)),s[20]||(s[20]=e("p",{class:"text-gray-500 text-sm mb-4"},"$19.99/month",-1)),s[21]||(s[21]=e("ul",{class:"text-sm space-y-1 text-gray-600"},[e("li",null,"✓ Unlimited CVs"),e("li",null,"✓ All templates"),e("li",null,"✓ AI Assistant")],-1)),t.value.plan!=="PREMIUM"?(d(),n("button",Y," Upgrade ")):b("",!0)],2)])])):(d(),n("div",Z,"Unable to load subscription info"))])):b("",!0)])])}}});export{ts as default};
