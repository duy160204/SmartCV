const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/user.api-DVaxPE5g.js","assets/index-D0LxdbPe.js","assets/index-B-R8cDt8.css"])))=>i.map(i=>d[i]);
import{z as j,r as w,A as N,d as A,c as n,q as V,a as e,s as u,t as T,v as c,B as E,o as r,l as U,F as C,j as k,i,n as I,C as F,m as S,p as O,_ as B,g as R,D as z,w as M,k as G,h as Y}from"./index-D0LxdbPe.js";import{cvApi as P,templateApi as J,aiApi as K,subscriptionApi as L}from"./user.api-DVaxPE5g.js";import{C as W}from"./CVRenderer-DKPugfv1.js";const D=j("cv",()=>{const v=w(null),s=w(null),a=w(!1),m=w(!1),p=w(null);async function d(o){a.value=!0;try{const t=(await P.getById(o)).data;typeof t.content=="string"&&(t.content=JSON.parse(t.content)),v.value=t,await f(t.templateId)}catch(x){console.error(x)}finally{a.value=!1}}async function f(o){try{const t=(await J.getById(o)).data;typeof t.fullContent=="string"?s.value=JSON.parse(t.fullContent):s.value=t.fullContent}catch(x){console.error("Failed to load template",x),s.value={html:"<h1>Error loading template</h1>",css:""}}}let g;N(()=>{var o;return(o=v.value)==null?void 0:o.content},o=>{o&&(m.value=!0,clearTimeout(g),g=setTimeout(async()=>{await $()},2e3))},{deep:!0});async function $(){if(v.value)try{m.value=!0,await P.autosave(v.value.id,v.value.content),p.value=new Date}catch(o){console.error("Autosave failed",o)}finally{m.value=!1}}async function h(o,x,t){if(v.value){await $();try{return m.value=!0,(await K.chat(v.value.id,`Original text: "${x}". Instruction: ${t}. Return ONLY the improved text.`)).data.message}finally{m.value=!1}}}async function _(){if(v.value)try{const o=await L.publicCV(v.value.id);v.value.isPublic=!0,v.value.publicToken=o.data.token||"generated-token"}catch(o){alert("Failed to publish: "+o.message)}}async function y(){if(v.value)try{await L.revokePublicLink(v.value.id),v.value.isPublic=!1,v.value.publicToken=void 0}catch(o){alert("Failed to unpublish: "+o.message)}}return{currentCV:v,currentTemplate:s,isLoading:a,isSaving:m,lastSaved:p,loadCV:d,saveCV:$,improveText:h,publishCV:_,unpublishCV:y}}),q={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},H={class:"bg-white rounded p-6 w-96 shadow-xl"},Q={class:"text-xs text-gray-500 mb-4"},X={class:"flex justify-end gap-2"},Z=A({__name:"AIImproveModal",props:{isOpen:{type:Boolean},currentText:{}},emits:["close","apply"],setup(v,{emit:s}){const a=s,m=w("");w(!1);const p=()=>{m.value&&(a("apply",m.value),m.value="")};return(d,f)=>v.isOpen?(r(),n("div",q,[e("div",H,[f[2]||(f[2]=e("h3",{class:"font-bold text-lg mb-2"},"âœ¨ AI Assistant",-1)),e("p",Q,'Current text: "'+T(v.currentText.substring(0,50))+'..."',1),f[3]||(f[3]=e("label",{class:"block text-sm font-medium mb-1"},"Instruction",-1)),u(e("input",{"onUpdate:modelValue":f[0]||(f[0]=g=>m.value=g),placeholder:"e.g. Fix grammar, Make it more professional...",class:"w-full border p-2 rounded mb-4",onKeyup:E(p,["enter"])},null,544),[[c,m.value]]),e("div",X,[e("button",{onClick:f[1]||(f[1]=g=>d.$emit("close")),class:"px-3 py-1 text-gray-600 hover:bg-gray-100 rounded"},"Cancel"),e("button",{onClick:p,class:"px-3 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 font-medium"}," Generate ")])])])):V("",!0)}}),ee={class:"flex flex-col h-full bg-slate-50 relative"},te={key:0,class:"absolute inset-0 bg-white bg-opacity-50 z-40 flex items-center justify-center"},oe={class:"flex border-b bg-white overflow-x-auto"},le=["onClick"],se={key:1,class:"p-6 flex-1 overflow-y-auto"},ne={key:0,class:"space-y-4"},re={class:"relative"},ae={key:1,class:"space-y-6"},ie={class:"flex justify-between items-center"},de=["onClick"],ue={class:"grid grid-cols-2 gap-4 mb-2"},ce=["onUpdate:modelValue"],pe=["onUpdate:modelValue"],me={class:"grid grid-cols-2 gap-4 mb-2"},be=["onUpdate:modelValue"],ve=["onUpdate:modelValue"],fe={key:2,class:"space-y-6"},ge={class:"flex justify-between items-center"},he=["onClick"],ye={class:"grid grid-cols-2 gap-4 mb-2"},xe=["onUpdate:modelValue"],_e=["onUpdate:modelValue"],Ve=["onUpdate:modelValue"],we={key:3,class:"space-y-6"},Ce={class:"flex justify-between items-center"},ke=["onClick"],$e={class:"flex-1"},Ue=["onUpdate:modelValue"],Ae={class:"w-1/3"},Te=["onUpdate:modelValue"],Ie={key:4,class:"space-y-6"},Se={class:"flex justify-between items-center"},De={key:0,class:"space-y-4"},Pe=["onClick"],Le={class:"grid grid-cols-2 gap-4 mb-2"},je=["onUpdate:modelValue"],Ne=["onUpdate:modelValue"],Ee={class:"mb-2"},Fe=["onUpdate:modelValue"],Oe=["onUpdate:modelValue"],Be=["onUpdate:modelValue"],Re={key:1,class:"text-gray-500 italic"},ze={key:5,class:"space-y-6"},Me={class:"flex justify-between items-center"},Ge={key:0},Ye=["onClick"],Je=["onUpdate:modelValue"],Ke=["onUpdate:modelValue"],We={key:6,class:"space-y-6"},qe={class:"flex justify-between items-center"},He={key:0},Qe=["onClick"],Xe=["onUpdate:modelValue"],Ze={class:"grid grid-cols-2 gap-4"},et=["onUpdate:modelValue"],tt=["onUpdate:modelValue"],ot={key:7,class:"space-y-6"},lt={class:"flex justify-between items-center"},st={key:0},nt=["onClick"],rt=["onUpdate:modelValue"],at={class:"grid grid-cols-2 gap-4"},it=["onUpdate:modelValue"],dt=["onUpdate:modelValue"],ut=A({__name:"CVForm",setup(v){const s=D(),a=w("profile"),m=w(!1),p=w(""),d=w(""),f=w(!1),g=(y,o)=>{p.value=y,d.value=o,m.value=!0},$=async y=>{var o,x;m.value=!1,f.value=!0;try{const t=await s.improveText(p.value,d.value,y);if(t){if(p.value==="profile.summary")(x=(o=s.currentCV)==null?void 0:o.content)!=null&&x.profile&&(s.currentCV.content.profile.summary=t);else if(p.value.startsWith("experience")){const b=p.value.split(".")}}}catch(t){alert("AI Failed: "+(t.message||t))}finally{f.value=!1}},h=y=>{var o;(o=s.currentCV)!=null&&o.content&&(s.currentCV.content[y]||(s.currentCV.content[y]=[]),s.currentCV.content[y].push({}))},_=(y,o)=>{var x,t;(t=(x=s.currentCV)==null?void 0:x.content)!=null&&t[y]&&s.currentCV.content[y].splice(Number(o),1)};return(y,o)=>{var x;return r(),n("div",ee,[U(Z,{isOpen:m.value,currentText:d.value,onClose:o[0]||(o[0]=t=>m.value=!1),onApply:$},null,8,["isOpen","currentText"]),f.value?(r(),n("div",te,[...o[16]||(o[16]=[e("span",{class:"text-purple-600 font-bold animate-pulse"},"âœ¨ AI Generating...",-1)])])):V("",!0),e("div",oe,[(r(),n(C,null,k(["profile","experience","education","skills","projects","languages","certifications","awards"],t=>e("button",{key:t,onClick:b=>a.value=t,class:I(["px-4 py-3 capitalize font-medium whitespace-nowrap",a.value===t?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"])},T(t),11,le)),64))]),(x=i(s).currentCV)!=null&&x.content?(r(),n("div",se,[a.value==="profile"?(r(),n("div",ne,[o[24]||(o[24]=e("h3",{class:"font-bold text-lg"},"Personal Details",-1)),e("div",null,[o[17]||(o[17]=e("label",{class:"block text-sm font-medium mb-1"},"Full Name",-1)),u(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>i(s).currentCV.content.profile.name=t),class:"w-full border p-2 rounded"},null,512),[[c,i(s).currentCV.content.profile.name]])]),e("div",null,[o[18]||(o[18]=e("label",{class:"block text-sm font-medium mb-1"},"Title",-1)),u(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>i(s).currentCV.content.profile.title=t),class:"w-full border p-2 rounded"},null,512),[[c,i(s).currentCV.content.profile.title]])]),e("div",null,[o[19]||(o[19]=e("label",{class:"block text-sm font-medium mb-1"},"Email",-1)),u(e("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>i(s).currentCV.content.profile.email=t),class:"w-full border p-2 rounded"},null,512),[[c,i(s).currentCV.content.profile.email]])]),e("div",null,[o[20]||(o[20]=e("label",{class:"block text-sm font-medium mb-1"},"Phone",-1)),u(e("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>i(s).currentCV.content.profile.phone=t),class:"w-full border p-2 rounded"},null,512),[[c,i(s).currentCV.content.profile.phone]])]),e("div",null,[o[21]||(o[21]=e("label",{class:"block text-sm font-medium mb-1"},"Website / Portfolio",-1)),u(e("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>i(s).currentCV.content.profile.website=t),class:"w-full border p-2 rounded"},null,512),[[c,i(s).currentCV.content.profile.website]])]),e("div",null,[o[22]||(o[22]=e("label",{class:"block text-sm font-medium mb-1"},"Location",-1)),u(e("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>i(s).currentCV.content.profile.location=t),class:"w-full border p-2 rounded"},null,512),[[c,i(s).currentCV.content.profile.location]])]),e("div",null,[o[23]||(o[23]=e("label",{class:"block text-sm font-medium mb-1"},"Summary",-1)),e("div",re,[u(e("textarea",{"onUpdate:modelValue":o[7]||(o[7]=t=>i(s).currentCV.content.profile.summary=t),rows:"4",class:"w-full border p-2 rounded"},null,512),[[c,i(s).currentCV.content.profile.summary]]),e("button",{onClick:o[8]||(o[8]=t=>g("profile.summary",i(s).currentCV.content.profile.summary)),class:"absolute bottom-2 right-2 text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded shadow hover:bg-purple-200"}," âœ¨ AI Improve ")])])])):V("",!0),a.value==="experience"?(r(),n("div",ae,[e("div",ie,[o[25]||(o[25]=e("h3",{class:"font-bold text-lg"},"Experience",-1)),e("button",{onClick:o[9]||(o[9]=t=>h("experience")),class:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded"},"+ Add")]),(r(!0),n(C,null,k(i(s).currentCV.content.experience,(t,b)=>(r(),n("div",{key:b,class:"bg-white p-4 border rounded shadow-sm relative group"},[e("button",{onClick:l=>_("experience",b),class:"absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},"âœ•",8,de),e("div",ue,[u(e("input",{"onUpdate:modelValue":l=>t.company=l,placeholder:"Company",class:"border p-2 rounded"},null,8,ce),[[c,t.company]]),u(e("input",{"onUpdate:modelValue":l=>t.position=l,placeholder:"Position",class:"border p-2 rounded"},null,8,pe),[[c,t.position]])]),e("div",me,[u(e("input",{"onUpdate:modelValue":l=>t.date=l,placeholder:"Date Range",class:"border p-2 rounded"},null,8,be),[[c,t.date]])]),e("div",null,[u(e("textarea",{"onUpdate:modelValue":l=>t.description=l,placeholder:"Description",rows:"3",class:"w-full border p-2 rounded mb-1"},null,8,ve),[[c,t.description]])])]))),128))])):V("",!0),a.value==="education"?(r(),n("div",fe,[e("div",ge,[o[26]||(o[26]=e("h3",{class:"font-bold text-lg"},"Education",-1)),e("button",{onClick:o[10]||(o[10]=t=>h("education")),class:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded"},"+ Add")]),(r(!0),n(C,null,k(i(s).currentCV.content.education,(t,b)=>(r(),n("div",{key:b,class:"bg-white p-4 border rounded shadow-sm relative group"},[e("button",{onClick:l=>_("education",b),class:"absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},"âœ•",8,he),e("div",ye,[u(e("input",{"onUpdate:modelValue":l=>t.school=l,placeholder:"School",class:"border p-2 rounded"},null,8,xe),[[c,t.school]]),u(e("input",{"onUpdate:modelValue":l=>t.degree=l,placeholder:"Degree",class:"border p-2 rounded"},null,8,_e),[[c,t.degree]])]),u(e("input",{"onUpdate:modelValue":l=>t.date=l,placeholder:"Date",class:"border p-2 rounded w-full"},null,8,Ve),[[c,t.date]])]))),128))])):V("",!0),a.value==="skills"?(r(),n("div",we,[e("div",Ce,[o[27]||(o[27]=e("h3",{class:"font-bold text-lg"},"Skills",-1)),e("button",{onClick:o[11]||(o[11]=t=>h("skills")),class:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded"},"+ Add")]),(r(!0),n(C,null,k(i(s).currentCV.content.skills,(t,b)=>(r(),n("div",{key:b,class:"bg-white p-4 border rounded shadow-sm relative group flex gap-2 items-center"},[e("button",{onClick:l=>_("skills",b),class:"absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},"âœ•",8,ke),e("div",$e,[u(e("input",{"onUpdate:modelValue":l=>t.name=l,placeholder:"Skill Name",class:"border p-2 rounded w-full"},null,8,Ue),[[c,t.name]])]),e("div",Ae,[u(e("input",{"onUpdate:modelValue":l=>t.level=l,placeholder:"Level (e.g. Expert)",class:"border p-2 rounded w-full"},null,8,Te),[[c,t.level]])])]))),128))])):V("",!0),a.value==="projects"?(r(),n("div",Ie,[e("div",Se,[o[28]||(o[28]=e("h3",{class:"font-bold text-lg"},"Projects",-1)),e("button",{onClick:o[12]||(o[12]=t=>h("projects")),class:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded"},"+ Add")]),i(s).currentCV.content.projects?(r(),n("div",De,[(r(!0),n(C,null,k(i(s).currentCV.content.projects,(t,b)=>(r(),n("div",{key:b,class:"bg-white p-4 border rounded shadow-sm relative group"},[e("button",{onClick:l=>_("projects",b),class:"absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},"âœ•",8,Pe),e("div",Le,[u(e("input",{"onUpdate:modelValue":l=>t.name=l,placeholder:"Project Name",class:"border p-2 rounded"},null,8,je),[[c,t.name]]),u(e("input",{"onUpdate:modelValue":l=>t.role=l,placeholder:"Your Role",class:"border p-2 rounded"},null,8,Ne),[[c,t.role]])]),e("div",Ee,[u(e("input",{"onUpdate:modelValue":l=>t.date=l,placeholder:"Date / Duration",class:"border p-2 rounded w-full"},null,8,Fe),[[c,t.date]])]),e("div",null,[u(e("textarea",{"onUpdate:modelValue":l=>t.description=l,placeholder:"Description",rows:"3",class:"w-full border p-2 rounded"},null,8,Oe),[[c,t.description]])]),e("div",null,[u(e("input",{"onUpdate:modelValue":l=>t.link=l,placeholder:"Link / URL",class:"border p-2 rounded w-full mt-2"},null,8,Be),[[c,t.link]])])]))),128))])):(r(),n("div",Re,"This section is not initialized in the data. Make sure to create a new CV to see this."))])):V("",!0),a.value==="languages"?(r(),n("div",ze,[e("div",Me,[o[29]||(o[29]=e("h3",{class:"font-bold text-lg"},"Languages",-1)),e("button",{onClick:o[13]||(o[13]=t=>h("languages")),class:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded"},"+ Add")]),i(s).currentCV.content.languages?(r(),n("div",Ge,[(r(!0),n(C,null,k(i(s).currentCV.content.languages,(t,b)=>(r(),n("div",{key:b,class:"bg-white p-4 border rounded shadow-sm relative group flex gap-4"},[e("button",{onClick:l=>_("languages",b),class:"absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},"âœ•",8,Ye),u(e("input",{"onUpdate:modelValue":l=>t.language=l,placeholder:"Language",class:"border p-2 rounded flex-1"},null,8,Je),[[c,t.language]]),u(e("input",{"onUpdate:modelValue":l=>t.proficiency=l,placeholder:"Proficiency",class:"border p-2 rounded flex-1"},null,8,Ke),[[c,t.proficiency]])]))),128))])):V("",!0)])):V("",!0),a.value==="certifications"?(r(),n("div",We,[e("div",qe,[o[30]||(o[30]=e("h3",{class:"font-bold text-lg"},"Certifications",-1)),e("button",{onClick:o[14]||(o[14]=t=>h("certifications")),class:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded"},"+ Add")]),i(s).currentCV.content.certifications?(r(),n("div",He,[(r(!0),n(C,null,k(i(s).currentCV.content.certifications,(t,b)=>(r(),n("div",{key:b,class:"bg-white p-4 border rounded shadow-sm relative group space-y-2"},[e("button",{onClick:l=>_("certifications",b),class:"absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},"âœ•",8,Qe),u(e("input",{"onUpdate:modelValue":l=>t.name=l,placeholder:"Certification Name",class:"border p-2 rounded w-full"},null,8,Xe),[[c,t.name]]),e("div",Ze,[u(e("input",{"onUpdate:modelValue":l=>t.issuer=l,placeholder:"Issuer",class:"border p-2 rounded"},null,8,et),[[c,t.issuer]]),u(e("input",{"onUpdate:modelValue":l=>t.date=l,placeholder:"Date",class:"border p-2 rounded"},null,8,tt),[[c,t.date]])])]))),128))])):V("",!0)])):V("",!0),a.value==="awards"?(r(),n("div",ot,[e("div",lt,[o[31]||(o[31]=e("h3",{class:"font-bold text-lg"},"Awards",-1)),e("button",{onClick:o[15]||(o[15]=t=>h("awards")),class:"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded"},"+ Add")]),i(s).currentCV.content.awards?(r(),n("div",st,[(r(!0),n(C,null,k(i(s).currentCV.content.awards,(t,b)=>(r(),n("div",{key:b,class:"bg-white p-4 border rounded shadow-sm relative group space-y-2"},[e("button",{onClick:l=>_("awards",b),class:"absolute top-2 right-2 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},"âœ•",8,nt),u(e("input",{"onUpdate:modelValue":l=>t.name=l,placeholder:"Award Name",class:"border p-2 rounded w-full"},null,8,rt),[[c,t.name]]),e("div",at,[u(e("input",{"onUpdate:modelValue":l=>t.issuer=l,placeholder:"Issuer",class:"border p-2 rounded"},null,8,it),[[c,t.issuer]]),u(e("input",{"onUpdate:modelValue":l=>t.year=l,placeholder:"Year",class:"border p-2 rounded"},null,8,dt),[[c,t.year]])])]))),128))])):V("",!0)])):V("",!0)])):V("",!0)])}}}),ct={class:"fixed bottom-4 right-4 z-50 flex flex-col items-end"},pt={key:0,class:"text-xl"},mt={key:1,class:"text-xl"},bt={class:"bg-white border rounded-lg shadow-xl mt-4 w-80 h-96 flex flex-col overflow-hidden transition-all origin-bottom-right"},vt={class:"flex-1 overflow-y-auto p-3 space-y-3 bg-gray-50"},ft={key:0,class:"text-center text-gray-500 text-sm mt-4"},gt={key:1,class:"text-xs text-gray-400 italic"},ht={class:"p-2 border-t bg-white"},yt=["disabled"],xt=["disabled"],_t=A({__name:"AIChatSidebar",setup(v){const s=D(),a=w(!1),m=w([]),p=w(""),d=w(!1),f=()=>{a.value=!a.value},g=async()=>{var h,_,y;if(!p.value.trim()||d.value)return;m.value.push({role:"user",content:p.value});const $=p.value;p.value="",d.value=!0;try{await s.saveCV();const{aiApi:o}=await B(async()=>{const{aiApi:t}=await import("./user.api-DVaxPE5g.js");return{aiApi:t}},__vite__mapDeps([0,1,2])),x=await o.chat((h=s.currentCV)==null?void 0:h.id,$);m.value.push({role:"assistant",content:x.data.message})}catch(o){m.value.push({role:"assistant",content:"Error: "+(((y=(_=o.response)==null?void 0:_.data)==null?void 0:y.message)||o.message)})}finally{d.value=!1}};return($,h)=>(r(),n("div",ct,[e("button",{onClick:f,class:I(["bg-indigo-600 hover:bg-indigo-700 text-white p-4 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 transform hover:scale-105",{"rotate-45":a.value}])},[a.value?(r(),n("span",mt,"âœ•")):(r(),n("span",pt,"ðŸ¤–"))],2),u(e("div",bt,[h[2]||(h[2]=e("div",{class:"bg-indigo-600 text-white p-3 font-bold flex justify-between"},[e("span",null,"Chat with AI Assistant")],-1)),e("div",vt,[m.value.length===0?(r(),n("div",ft,[...h[1]||(h[1]=[S(" Ask me anything about your CV! ",-1),e("br",null,null,-1),S(" I can help improve wording, suggest skills, or spot errors. ",-1)])])):V("",!0),(r(!0),n(C,null,k(m.value,(_,y)=>(r(),n("div",{key:y,class:I(["max-w-[85%] rounded p-2 text-sm",_.role==="user"?"bg-blue-100 ml-auto text-blue-900":"bg-white border text-gray-800 self-start"])},T(_.content),3))),128)),d.value?(r(),n("div",gt,"AI is thinking...")):V("",!0)]),e("div",ht,[e("form",{onSubmit:O(g,["prevent"]),class:"flex gap-2"},[u(e("input",{"onUpdate:modelValue":h[0]||(h[0]=_=>p.value=_),placeholder:"Type a message...",class:"flex-1 border rounded px-2 py-1 text-sm focus:outline-none focus:border-indigo-500",disabled:d.value},null,8,yt),[[c,p.value]]),e("button",{type:"submit",class:"bg-indigo-600 text-white px-3 py-1 rounded text-sm disabled:opacity-50",disabled:!p.value.trim()||d.value}," Send ",8,xt)],32)])],512),[[F,a.value]])]))}}),Vt={key:0,class:"h-screen flex flex-col"},wt={class:"h-16 bg-white border-b flex items-center px-4 justify-between z-10"},Ct={class:"flex items-center gap-4"},kt={class:"flex items-center gap-4"},$t={key:0,class:"text-sm text-yellow-600"},Ut={key:1,class:"text-sm text-green-600"},At={class:"relative group"},Tt={class:"hidden group-hover:block absolute top-full right-0 bg-white border shadow-lg p-4 w-80 rounded z-50"},It={key:0},St=["value"],Dt={key:1},Pt={class:"flex flex-1 overflow-hidden"},Lt={class:"w-1/2 md:w-5/12 lg:w-1/3 bg-white border-r overflow-y-auto"},jt={class:"flex-1 bg-gray-100 overflow-hidden relative"},Nt={key:1,class:"h-screen flex items-center justify-center"},Bt=A({__name:"CVEditorPage",setup(v){const s=z(),a=D();R(()=>{const p=Number(s.params.id);p&&a.loadCV(p)});const m=async()=>{var p;if((p=a.currentCV)!=null&&p.id)try{const d=await Y.get(`/cv/${a.currentCV.id}/download`,{responseType:"blob"}),f=window.URL.createObjectURL(new Blob([d.data])),g=document.createElement("a");g.href=f,g.setAttribute("download",`${a.currentCV.title||"cv"}.pdf`),document.body.appendChild(g),g.click(),g.remove()}catch(d){alert("Download failed: "+d.message)}};return(p,d)=>{const f=G("router-link");return i(a).currentCV&&i(a).currentTemplate?(r(),n("div",Vt,[e("header",wt,[e("div",Ct,[U(f,{to:"/dashboard",class:"text-gray-500 hover:text-black"},{default:M(()=>[...d[4]||(d[4]=[S("â† Back to Dashboard",-1)])]),_:1}),u(e("input",{"onUpdate:modelValue":d[0]||(d[0]=g=>i(a).currentCV.title=g),onBlur:d[1]||(d[1]=g=>i(a).saveCV()),class:"font-bold text-lg border-transparent hover:border-gray-300 border px-2 rounded"},null,544),[[c,i(a).currentCV.title]])]),e("div",kt,[i(a).isSaving?(r(),n("span",$t,"Saving...")):i(a).lastSaved?(r(),n("span",Ut,"Saved "+T(i(a).lastSaved.toLocaleTimeString()),1)):V("",!0),e("div",At,[d[7]||(d[7]=e("button",{class:"text-gray-600 hover:text-blue-600 font-medium"},"Share",-1)),e("div",Tt,[i(a).currentCV.isPublic?(r(),n("div",It,[d[5]||(d[5]=e("p",{class:"text-sm text-green-600 font-bold mb-2"},"CV is Public",-1)),e("input",{readonly:"",value:`http://localhost:3000/cv/public/${i(a).currentCV.publicToken}`,class:"w-full text-xs border p-1 rounded mb-2 bg-gray-50"},null,8,St),e("button",{onClick:d[2]||(d[2]=g=>i(a).unpublishCV()),class:"text-xs text-red-500 hover:underline"},"Revoke Link")])):(r(),n("div",Dt,[d[6]||(d[6]=e("p",{class:"text-sm text-gray-600 mb-2"},"Publish your CV to get a shareable link.",-1)),e("button",{onClick:d[3]||(d[3]=g=>i(a).publishCV()),class:"w-full bg-blue-100 text-blue-700 py-1 rounded text-sm hover:bg-blue-200"},"Generate Link")]))])]),e("button",{onClick:m,class:"bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700"},"Download PDF")])]),e("div",Pt,[e("div",Lt,[U(ut)]),e("div",jt,[U(W,{html:i(a).currentTemplate.html,css:i(a).currentTemplate.css,data:i(a).currentCV.content},null,8,["html","css","data"]),U(_t)])])])):(r(),n("div",Nt," Loading Editor... "))}}});export{Bt as default};
