import{d as v,e as x,r as b,g as h,D as _,u as k,E as w,c as n,a as o,q as u,l as d,w as p,k as R,o as l,m}from"./index-D0LxdbPe.js";const E={class:"min-h-screen flex items-center justify-center bg-gray-50"},I={class:"text-center p-8 bg-white rounded shadow-lg"},P={key:0,class:"animate-pulse"},A={key:1},C={key:2},N={class:"flex justify-center gap-4"},B=v({__name:"PaymentReturnPage",setup(T){const f=_(),c=k(),r=x(),t=b("processing");let s=null;return h(async()=>{if(f.query.vnp_ResponseCode==="00"){t.value="processing";let e=0;const a=10;s=setInterval(async()=>{var i;e++;try{await r.checkAuth(),(i=r.user)!=null&&i.plan&&r.user.plan!=="FREE"?(t.value="success",s&&clearInterval(s),setTimeout(()=>c.push("/dashboard"),3e3)):console.log("Still FREE, polling...",e)}catch(y){console.error("Auth check failed:",y)}e>=a&&t.value!=="success"&&(s&&clearInterval(s),t.value="success",setTimeout(()=>c.push("/dashboard"),2e3))},1e3)}else t.value="failed"}),w(()=>{s&&(clearInterval(s),s=null)}),(g,e)=>{const a=R("router-link");return l(),n("div",E,[o("div",I,[t.value==="processing"?(l(),n("div",P,[...e[0]||(e[0]=[o("h1",{class:"text-2xl font-bold mb-2"},"Processing Payment...",-1),o("p",null,"Please wait while we confirm your subscription.",-1)])])):u("",!0),t.value==="success"?(l(),n("div",A,[...e[1]||(e[1]=[o("h1",{class:"text-2xl font-bold mb-2 text-green-600"},"Upgrade Successful!",-1),o("p",null,"Redirecting to dashboard...",-1)])])):u("",!0),t.value==="failed"?(l(),n("div",C,[e[4]||(e[4]=o("h1",{class:"text-2xl font-bold mb-2 text-red-600"},"Payment Failed",-1)),e[5]||(e[5]=o("p",{class:"mb-4 text-gray-600"},"We couldn't confirm your payment. If you were charged, please contact support.",-1)),o("div",N,[d(a,{to:"/",class:"bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300"},{default:p(()=>[...e[2]||(e[2]=[m("Go Home",-1)])]),_:1}),d(a,{to:"/upgrade",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},{default:p(()=>[...e[3]||(e[3]=[m("Try Again",-1)])]),_:1})])])):u("",!0)])])}}});export{B as default};
