import{d as P,e as T,r as u,g as U,h as v,f as j,c as a,a as o,l as N,w as S,k as q,s as w,v as M,y as z,F as B,j as L,m as x,t as f,n as h,u as O,o as l,q as b}from"./index-DLU9CfYJ.js";const $={class:"min-h-screen bg-gray-50 p-8"},I={class:"max-w-6xl mx-auto"},D={class:"flex items-center mb-8"},A={class:"bg-white p-6 rounded shadow mb-8"},G={class:"flex justify-between items-center mb-4"},H={class:"flex items-center gap-2 text-sm cursor-pointer"},J={key:0},K={key:1,class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6"},Q=["onClick"],W=["onClick"],X={class:"aspect-[210/297] bg-gray-200 mb-4 rounded overflow-hidden relative"},Y=["src"],Z={key:1,class:"flex items-center justify-center h-full text-gray-400"},ee={key:2,class:"absolute top-2 right-2 bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-1 rounded shadow-sm z-20"},te={key:0,class:"ml-1"},se={key:3,class:"absolute inset-0 bg-gray-900 bg-opacity-10 flex items-center justify-center z-10"},oe={class:"font-bold text-center"},ae={class:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t flex justify-between items-center px-10 shadow-lg"},le={class:"text-gray-500"},re={key:0,class:"font-bold text-blue-600"},ne={key:1},ie=["disabled"],ce=P({__name:"CreateCVPage",setup(de){const k=O(),C=T(),p=u([]),d=u([]),_=u(!0),n=u(null),g=u("Untitled CV"),y=u(!1);U(async()=>{try{const[t,e]=await Promise.all([v.get("/templates"),v.get("/cv/favorites")]);p.value=t.data,d.value=e.data}catch(t){console.error(t)}finally{_.value=!1}});const m=t=>d.value.some(e=>e.templateId===t),R=async(t,e)=>{var r,s;e.stopPropagation();try{m(t)?(await v.delete(`/cv/template/${t}/favorite`),d.value=d.value.filter(i=>i.templateId!==t)):(await v.post(`/cv/template/${t}/favorite`),d.value.push({templateId:t}))}catch(i){alert("Failed to update favorite: "+(((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||i.message))}},V=j(()=>{if(y.value){const t=d.value.map(e=>e.templateId);return p.value.filter(e=>t.includes(e.id))}return p.value}),c=t=>{var r;const e=((r=C.user)==null?void 0:r.plan)||"FREE";return!(t.planRequired==="FREE"||e==="PREMIUM"||e==="PRO"&&t.planRequired==="PRO")},F=t=>{c(t)||(n.value=t.id)},E=async()=>{var t,e;if(n.value)try{const r=await v.post("/cv",{title:g.value,templateId:n.value,content:{profile:{name:"",summary:""},education:[],experience:[],skills:[]}});k.push(`/cv/editor/${r.data.id}`)}catch(r){alert("Failed to create: "+(((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||r.message))}};return(t,e)=>{const r=q("router-link");return l(),a("div",$,[o("div",I,[o("div",D,[N(r,{to:"/",class:"text-gray-500 mr-4"},{default:S(()=>[...e[2]||(e[2]=[x("‚Üê Back",-1)])]),_:1}),e[3]||(e[3]=o("h1",{class:"text-3xl font-bold"},"Create New CV",-1))]),o("div",A,[e[4]||(e[4]=o("label",{class:"block font-bold mb-2"},"CV Title",-1)),w(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),class:"w-full border p-2 rounded text-lg",placeholder:"e.g. Software Engineer 2024"},null,512),[[M,g.value]])]),o("div",G,[e[6]||(e[6]=o("h2",{class:"text-xl font-bold"},"Select a Template",-1)),o("label",H,[w(o("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=s=>y.value=s),class:"form-checkbox"},null,512),[[z,y.value]]),e[5]||(e[5]=o("span",null,"Show Favorites Only",-1))])]),_.value?(l(),a("div",J,"Loading templates...")):(l(),a("div",K,[(l(!0),a(B,null,L(V.value,s=>(l(),a("div",{key:s.id,onClick:i=>F(s),class:h(["border-2 rounded p-4 transition relative",c(s)?"opacity-70 cursor-not-allowed bg-gray-50":"cursor-pointer",n.value===s.id?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300 bg-white"])},[c(s)?b("",!0):(l(),a("button",{key:0,onClick:i=>R(s.id,i),class:h(["absolute top-2 left-2 z-10 text-2xl transition",m(s.id)?"text-red-500":"text-gray-300 hover:text-red-300"])},f(m(s.id)?"‚ù§Ô∏è":"ü§ç"),11,W)),o("div",X,[s.thumbnailUrl?(l(),a("img",{key:0,src:s.thumbnailUrl,class:"w-full h-full object-cover"},null,8,Y)):(l(),a("div",Z,"Preview")),s.planRequired!=="FREE"?(l(),a("div",ee,[x(f(s.planRequired)+" ",1),c(s)?(l(),a("span",te,"üîí")):b("",!0)])):b("",!0),c(s)?(l(),a("div",se,[...e[7]||(e[7]=[o("div",{class:"bg-white/90 px-3 py-1 rounded text-xs font-bold text-gray-700 shadow"}," Upgrade to Unlock ",-1)])])):b("",!0)]),o("h3",oe,f(s.name),1)],10,Q))),128))])),o("div",ae,[o("div",le,[e[8]||(e[8]=x(" Selected: ",-1)),n.value?(l(),a("span",re,"Template #"+f(n.value),1)):(l(),a("span",ne,"None"))]),o("button",{onClick:E,disabled:!n.value,class:h(["px-8 py-3 rounded font-bold text-white",n.value?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"])}," Create CV ",10,ie)])])])}}});export{ce as default};
